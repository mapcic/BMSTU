clear; clc;

e = 1.6e-19; eVtoJ = e; JtoEv = e^(-1); 
me = 9.11*1e-31; nm = 1e-9;

% Do it smooth
dis = 1;
% atoms' radius
dx = 0.56; %nm
dx = dx/dis;
 
% Count layers
a = [16 17 18 19 20 21 22 23]; % monolayers
b = 6;
c = 6;

a = a*dis;
b = b*dis;
c = c*dis;

sizeHS = a + b + c + b + a;

% Fermi Energy
EFermi = 1.51*1e-20; % J

% Applyied voltage
dU = 0:0.01:0.5;

% Ec
Ec1 = [zeros(1, a(1)), 0.5*ones(1, b), zeros(1, c), 0.5*ones(1, b), zeros(1, a(1))];
Ec2 = [zeros(1, a(2)), 0.5*ones(1, b), zeros(1, c), 0.5*ones(1, b), zeros(1, a(2))];
Ec3 = [zeros(1, a(3)), 0.5*ones(1, b), zeros(1, c), 0.5*ones(1, b), zeros(1, a(3))];
Ec4 = [zeros(1, a(4)), 0.5*ones(1, b), zeros(1, c), 0.5*ones(1, b), zeros(1, a(4))];
Ec5 = [zeros(1, a(5)), 0.5*ones(1, b), zeros(1, c), 0.5*ones(1, b), zeros(1, a(5))];
Ec6 = [zeros(1, a(6)), 0.5*ones(1, b), zeros(1, c), 0.5*ones(1, b), zeros(1, a(6))];
Ec7 = [zeros(1, a(7)), 0.5*ones(1, b), zeros(1, c), 0.5*ones(1, b), zeros(1, a(7))];
Ec8 = [zeros(1, a(8)), 0.5*ones(1, b), zeros(1, c), 0.5*ones(1, b), zeros(1, a(8))];

% meff
meff1 = [0.067*ones(1, a(1)), 0.15*ones(1, b), 0.067*ones(1, c), 0.15*ones(1, b), 0.067*ones(1, a(1))];
meff2 = [0.067*ones(1, a(2)), 0.15*ones(1, b), 0.067*ones(1, c), 0.15*ones(1, b), 0.067*ones(1, a(2))];
meff3 = [0.067*ones(1, a(3)), 0.15*ones(1, b), 0.067*ones(1, c), 0.15*ones(1, b), 0.067*ones(1, a(3))];
meff4 = [0.067*ones(1, a(4)), 0.15*ones(1, b), 0.067*ones(1, c), 0.15*ones(1, b), 0.067*ones(1, a(4))];
meff5 = [0.067*ones(1, a(5)), 0.15*ones(1, b), 0.067*ones(1, c), 0.15*ones(1, b), 0.067*ones(1, a(5))];
meff6 = [0.067*ones(1, a(6)), 0.15*ones(1, b), 0.067*ones(1, c), 0.15*ones(1, b), 0.067*ones(1, a(6))];
meff7 = [0.067*ones(1, a(7)), 0.15*ones(1, b), 0.067*ones(1, c), 0.15*ones(1, b), 0.067*ones(1, a(7))];
meff8 = [0.067*ones(1, a(8)), 0.15*ones(1, b), 0.067*ones(1, c), 0.15*ones(1, b), 0.067*ones(1, a(8))];

reserve = 10;

tic

J1 = getJ(dx*nm, ...
	meff1*me, ...
	Ec1*eVtoJ, ...
	dU*eVtoJ, ...
	EFermi, ...
	reserve, ...
	a(1),...
	b,...
	c...
);

J2 = getJ(dx*nm, ...
	meff2*me, ...
	Ec2*eVtoJ, ...
	dU*eVtoJ, ...
	EFermi, ...
	reserve, ...
	a(2),...
	b,...
	c...
);

J3 = getJ(dx*nm, ...
	meff3*me, ...
	Ec3*eVtoJ, ...
	dU*eVtoJ, ...
	EFermi, ...
	reserve, ...
	a(3),...
	b,...
	c...
);

J4 = getJ(dx*nm, ...
	meff4*me, ...
	Ec4*eVtoJ, ...
	dU*eVtoJ, ...
	EFermi, ...
	reserve, ...
	a(4),...
	b,...
	c...
);

J5 = getJ(dx*nm, ...
	meff5*me, ...
	Ec5*eVtoJ, ...
	dU*eVtoJ, ...
	EFermi, ...
	reserve, ...
	a(5),...
	b,...
	c...
);

J6 = getJ(dx*nm, ...
	meff6*me, ...
	Ec6*eVtoJ, ...
	dU*eVtoJ, ...
	EFermi, ...
	reserve, ...
	a(6),...
	b,...
	c...
);
J7 = getJ(dx*nm, ...
	meff7*me, ...
	Ec7*eVtoJ, ...
	dU*eVtoJ, ...
	EFermi, ...
	reserve, ...
	a(7),...
	b,...
	c...
);
J8 = getJ(dx*nm, ...
	meff8*me, ...
	Ec8*eVtoJ, ...
	dU*eVtoJ, ...
	EFermi, ...
	reserve, ...
	a(8),...
	b,...
	c...
);


toc

showResult(dx*nm, sizeHS, J1, J2, J3, J4, J5, J6, J7, J8, dU, a); % img 3.8 img 3.9